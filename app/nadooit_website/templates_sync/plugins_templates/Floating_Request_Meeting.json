{
    "id": "867112628084604930",
    "name": "Floating_Request_Meeting",
    "html": "{% load django_htmx %}\n\n<button id=\"meeting-request-btn\"\n        hx-post=\"{% url 'nadooit_website:create_meeting_request' %}\"\n        hx-trigger=\"click\"\n        hx-response-headers=\"Content-Type\"\n        hx-target=\"#meeting-request\"\n        hx-vals='{\"session_id\": \"{{ session_id }}\"}' {# Use hx-vals to include session_id parameter #}\n        class=\"btn btn-primary floating-btn\">\n  Request Meeting\n</button>\n\n<style>\n  .floating-btn {\n    position: fixed;\n    bottom: 20px;\n    right: 20px;\n    border-radius: 50%;\n    padding: 10px;\n    background-color: red;\n    color: white;\n    cursor: pointer;\n  }\n</style>\n\n<div id=\"meeting-request\"></div>\n\n<script>\ndocument.body.addEventListener(\"htmx:afterOnLoad\", function (event) {\n  const detail = event.detail;\n  if (detail.xhr.status === 200) {\n    const data = JSON.parse(detail.xhr.responseText);\n    if (data.status === \"success\") {\n      // Update the button color based on the meeting status\n      const meetingStatus = data.meeting_status;\n      const button = document.getElementById(\"meeting-request-btn\");\n      if (meetingStatus === \"pending\") {\n        button.style.backgroundColor = \"red\";\n      } else if (meetingStatus === \"accepted\") {\n        button.style.backgroundColor = \"green\";\n      }\n      \n      // Initialize Jitsi Meet with the room UUID\n      initializeJitsiMeet(data.room_uuid);\n    } else {\n      console.error(\"Error creating MeetingRequest:\", data.error);\n    }\n  } else {\n    console.error(\"Error sending htmx request:\", detail.xhr.statusText);\n  }\n});\n\nasync function initializeJitsiMeet(roomUUID) {\n  const domain = roomUUID;\n  const roomName = 'TEST';\n  const options = {\n    roomName: roomName,\n    width: 700,\n    height: 700,\n    parentNode: document.querySelector('#meet'),\n    lang: 'de'\n  };\n  const api = new JitsiMeetExternalAPI(domain, options);\n}\n</script>"
}
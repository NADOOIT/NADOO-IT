{
    "id": "862879106506555393",
    "name": "Floating Request Meeting",
    "html": "{% load django_htmx %}\r\n\r\n<button id=\"meeting-request-btn\"\r\n        hx-post=\"{% url 'nadooit_website:create_meeting_request' %}\"\r\n        hx-trigger=\"click\"\r\n        hx-response-headers=\"Content-Type\"\r\n        hx-target=\"#meeting-request\"\r\n        hx-vals='{\"session_id\": \"{{ session_id }}\"}' {# Use hx-vals to include session_id parameter #}\r\n        class=\"btn btn-primary floating-btn\">\r\n  Request Meeting\r\n</button>\r\n\r\n<style>\r\n  .floating-btn {\r\n    position: fixed;\r\n    bottom: 20px;\r\n    right: 20px;\r\n    border-radius: 50%;\r\n    padding: 10px;\r\n    background-color: red;\r\n    color: white;\r\n    cursor: pointer;\r\n  }\r\n</style>\r\n\r\n<div id=\"meeting-request\"></div>\r\n\r\n<script>\r\ndocument.body.addEventListener(\"htmx:afterOnLoad\", function (event) {\r\n  const detail = event.detail;\r\n  if (detail.xhr.status === 200) {\r\n    const data = JSON.parse(detail.xhr.responseText);\r\n    if (data.status === \"success\") {\r\n      // Update the button color based on the meeting status\r\n      const meetingStatus = data.meeting_status;\r\n      const button = document.getElementById(\"meeting-request-btn\");\r\n      if (meetingStatus === \"pending\") {\r\n        button.style.backgroundColor = \"red\";\r\n      } else if (meetingStatus === \"accepted\") {\r\n        button.style.backgroundColor = \"green\";\r\n      }\r\n      \r\n      // Initialize Jitsi Meet with the room UUID\r\n      initializeJitsiMeet(data.room_uuid);\r\n    } else {\r\n      console.error(\"Error creating MeetingRequest:\", data.error);\r\n    }\r\n  } else {\r\n    console.error(\"Error sending htmx request:\", detail.xhr.statusText);\r\n  }\r\n});\r\n\r\nasync function initializeJitsiMeet(roomUUID) {\r\n  const domain = roomUUID;\r\n  const roomName = 'TEST';\r\n  const options = {\r\n    roomName: roomName,\r\n    width: 700,\r\n    height: 700,\r\n    parentNode: document.querySelector('#meet'),\r\n    lang: 'de'\r\n  };\r\n  const api = new JitsiMeetExternalAPI(domain, options);\r\n}\r\n</script>"
}